<!doctype html public "-//W3C//DTD HTML 4.0//EN">
<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2000 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="icon" href="../../chimera16.png" type="image/png">
<title>Creating Molecules</title>
</head>

<body>
<h1>Creating Molecules</h1>
<p>Molecules may be created using only Python code.  The following
example shows how to create a single water molecule.</p>
<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2000 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->
<h2>Example <a href="CreateMolecule.py"><i>CreateMolecule.py</i></a></h2>
<p>
Function <code>createWater</code> creates a water molecule.<br>
<spacer type="vertical" size=5>
<code>
<font color="red">def createWater():<br></font>
</code>
<dl><dd>
<p>
Import the object that tracks open models and several
classes from the <code>chimera</code> module.<br>
<spacer type="vertical" size=5>
<code>
<font color="red">from chimera import openModels, Molecule, Element, Coord<br></font>
</code>
<p>
Create an instance of a Molecule<br>
<spacer type="vertical" size=5>
<code>
<font color="red">m = Molecule()<br></font>
</code>
<p>
Molecule contains residues.  For our example, we will
create a single residue of HOH.  The four arguments are:
the residue type, chain identifier, sequence number and
insertion code.  Note that a residue is created as part
of a particular molecule.<br>
<spacer type="vertical" size=5>
<code>
<font color="red">r = m.newResidue("HOH", " ", 1, " ")<br></font>
</code>
<p>
Now we create the atoms.  The newAtom function arguments
are the atom name and its element type, which must be
an instance of Element.  You can create an Element
instance from either its name or atomic number.<br>
<spacer type="vertical" size=5>
<code>
<font color="red">atomO = m.newAtom("O", Element("O"))<br></font>
<font color="red">atomH1 = m.newAtom("H1", Element(1))<br></font>
<font color="red">atomH2 = m.newAtom("H2", Element("H"))<br></font>
</code>
<p>
Set the coordinates for the atoms so that they can be displayed.<br>
<spacer type="vertical" size=5>
<code>
<font color="red">from math import radians, sin, cos<br></font>
<font color="red">bondLength = 0.95718<br></font>
<font color="red">angle = radians(104.474)<br></font>
<font color="red">atomO.setCoord(Coord(0, 0, 0))<br></font>
<font color="red">atomH1.setCoord(Coord(bondLength, 0, 0))<br></font>
<font color="red">atomH2.setCoord(Coord(bondLength * cos(angle), bondLength * sin(angle), 0))<br></font>
</code>
<p>
Next, we add the atoms into the residue.<br>
<spacer type="vertical" size=5>
<code>
<font color="red">r.addAtom(atomO)<br></font>
<font color="red">r.addAtom(atomH1)<br></font>
<font color="red">r.addAtom(atomH2)<br></font>
</code>
<p>
Next, we create the bonds between the atoms.<br>
<spacer type="vertical" size=5>
<code>
<font color="red">m.newBond(atomO, atomH1)<br></font>
<font color="red">m.newBond(atomO, atomH2)<br></font>
</code>
<p>
Finally, we add the new molecule into the list of
open models.<br>
<spacer type="vertical" size=5>
<code>
<font color="red">openModels.add([m])<br></font>
</code>
</dl>
<p>
Call the function to create a water molecule.<br>
<spacer type="vertical" size=5>
<code>
<font color="red">createWater()<br></font>
</code>
<h2>Code Notes</h2>
<p>If multiple water molecules were needed, they should probably be created as
multiple residues (with different sequence numbers) in the same molecule.</p>
<h2>Running the Example</h2>
<p>
You can execute the example code by downloading the linked Python script and
opening it with the
<a href="http://www.cgl.ucsf.edu/chimera/docs/UsersGuide/opensave.html#opendialog">File&rarr;Open</a>
menu item or with the
<a href="http://www.cgl.ucsf.edu/chimera/docs/UsersGuide/midas/open.html">open</a>
command.  Note that the <i>.py</i> extension is required for the open
dialog/command to recognize that the file is a Python script.
</body>
</html>
