<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2008-2015 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html>
<head>
<TITLE>Making Movies</TITLE>
<style type="text/css">
A.nounder:link {text-decoration: none}
A.nounder:visited {text-decoration: none}
A.nounder:hover {text-decoration: underline; color: red;}
</style>
</head>
<body>
<h2><a name="top">Making Movies</a></h2>
<p>
Chimera includes the following approaches for
capturing image frames and assembling them into a movie file:
<ul>
<li> <a href="../ContributedSoftware/recorder/recorder.html"><b>Movie 
Recorder</b></a> is a graphical interface with buttons to start recording,
stop recording, and encode the saved images as a movie file.
<li> The command <a href="midas/movie.html"><b>movie</b></a> provides
access to the same features, but with keywords and arguments.   
This allows integration of movie recording and <a href="#content">content</a>
within a single <a href="#examples">script</a>.
<li><a href="../ContributedSoftware/movie/framemovie.html" 
target="_top"><b>MD Movie</b></a> provides an interface for 
<a href="../ContributedSoftware/movie/movie.html#recording">recording
trajectories</a> such as from molecular dynamics or
<a href="../ContributedSoftware/morph/morph.html"><b>Morph Conformations</b></a>
<li><a href="../ContributedSoftware/morphmap/morphmap.html"><b>Morph 
Map</b></a> creates an interpolated progression between two sets of 
<a href="filetypes.html#volume">volume data</a> and
provides an interface for
<a href="../ContributedSoftware/morphmap/morphmap.html#recording">recording</a>
the result
<li>
<a href="../ContributedSoftware/animation/frameanimation.html"
target="_top"><b>Animation</b></a> (under development) 
allows saving Chimera 
<a href="../ContributedSoftware/animation/animation.html#scenes">scenes</a>,
arranging them into a
<a href="../ContributedSoftware/animation/animation.html#keyframes">timeline</a>, and
<a href="../ContributedSoftware/animation/animation.html#recording">recording</a>
the resulting animation 
<li>Additional features step through different 
displays over time and can be used together with
<a href="../ContributedSoftware/recorder/recorder.html"><b>Movie 
Recorder</b></a> or the <a href="midas/movie.html"><b>movie</b></a> command:
  <ul>
  <li><a href="../ContributedSoftware/volseries/volseries.html"><b>Volume 
  Series</b></a> (or command <a href="midas/vseries.html"><b>vseries</b></a>)
  displays an ordered sequence 
  of <a href="filetypes.html#volume">volume data</a> sets
  <li>the <a href="../ContributedSoftware/volumeviewer/volumeviewer.html#planes">planes</a>
  feature in 
  <a href="../ContributedSoftware/volumeviewer/framevolumeviewer.html"
  target="_top"><b>Volume Viewer</b></a> 
  (or <a href="midas/volume.html"><b>volume</b></a> command with the
  <a href="midas/volume.html#planes">planes</a> keyword)
  displays sequential planes or slabs of data
  <li>volume morphing can be scripted 
  with <a href="midas/vop.html#morph"><b>vop morph</b></a>
  <li>molecular trajectory playback can be scripted with
  <A href="midas/coordset.html"><b>coordset</b></A>
  </ul>
</ul>
The image frames can be rendered directly by Chimera
or created by <a href="raytracing.html">raytracing with POV-Ray</a>.
See below for information on developing <a href="#content">movie content</a> 
and troubleshooting <a href="#powerpoint">problems in PowerPoint</a>.
See also: 
<a href="print.html#tips">tips on preparing images</a>
</p>

<a name="moviecommands"></a>
<h3><a href="#top" class="nounder"><b>&larr;</b></a>
<a name="content">Movie Content</a></h3>
<p>
During recording, structures can be manipulated interactively and
<a href="framecommand.html" target="_top">commands</a> entered.
However, for reproducibility and smoother results, often a
Chimera <a href="#examples">command file</a> (script) will be used instead.
The commands listed below are especially useful for 
scripting continuous motion and/or specifying movie content. 
See also: <a href="#examples">movie script examples</a>, 
<a href="https://www.rbvi.ucsf.edu/chimera/data/movie-howto-mar2012/movie_examples.html" 
target="_blank">video mini-examples</a> for individual commands
</p>
<blockquote>
<A href="midas/2dlabels.html"><b>2dlabels</b></A>
- display 2D labels, which can be faded
in or out over a specified number of frames
<br>
<A href="midas/background.html"><b>background</b></A>
- set background color(s) or image
<br>
<A href="midas/clip.html"><b>clip</b></A>
- move <a href="sideview.html#sideview">global clipping planes</a>
<br>
<A href="midas/cofr.html"><b>cofr</b></A>
- change the center of rotation
<br>
<A href="midas/coordset.html"><b>coordset</b></A>
- play through frames of a trajectory
<br>
<A href="midas/fly.html"><b>fly</b></A>
- smoothly traverse a series of positions previously saved with
<A href="midas/savepos.html"><b>savepos</b></A>
<br>
<A href="midas/freeze.html"><b>freeze</b></A>
- stop all motion
<br>
<A href="midas/mclip.html"><b>mclip</b></A>
- control <a href="../ContributedSoftware/per-model/per-model.html">per-model 
clipping</a>
<br>
<A href="midas/move.html"><b>move</b></A>
- translate models
<br>
<A href="midas/movie.html"><b>movie</b></A>
- capture image frames and assemble them into a movie file
<br>
<A href="midas/perframe.html"><b>perframe</b></A>
- specify commands to be executed at each display frame 
<br>
<A href="midas/play.html"><b>play</b></A>
- script various complex motions
<br>
<A href="midas/reset.html"><b>reset</b></A>
- interpolate from the current position to one previously saved with
<A href="midas/savepos.html"><b>savepos</b></A>
<br>
<A href="midas/rock.html"><b>rock</b></A>
- rotate models back and forth (oscillate)
<br>
<A href="midas/roll.html"><b>roll</b></A>
- rotate models
<br>
<A href="midas/rotation.html"><b>rotation</b></A>
- rotate bonds (adjust torsions)
<br>
<A href="midas/savepos.html"><b>savepos</b></A>
- save and name a &ldquo;position&rdquo;
(model transformations, scale, <i>etc.</i>)
<br>
<A href="midas/scale.html"><b>scale</b></A>
- scale the view
<br>
<A href="midas/scene.html"><b>scene</b></A>
- save and restore &ldquo;scenes&rdquo;
(positions plus styles, colors, labels, <i>etc.</i>)
<br>
<A href="midas/section.html"><b>section</b></A>
- move the clipping planes in parallel
<br>
<A href="midas/select.html#older"><b>select</b></A> - 
<a href="mouse.html#activedef">activate/deactivate</a> models for motion
<br>
<A href="midas/set.html"><b>set</b></A>
- set visual effects, make models rotate about individual centers,
echo command-file lines as they are executed
<br>
<A href="midas/thickness.html"><b>thickness</b></A>
- move the clipping planes in opposite directions
<br>
<a href="midas/transparency.html"><b>transparency</b></a>
- make atoms/bonds, ribbons, and surfaces transparent
<br>
<A href="midas/turn.html"><b>turn</b></A>
- rotate models
<br>
<A href="midas/vop.html#morph"><b>vop morph</b></A>
- morph (interpolate) between two or more volume data sets
<br>
<A href="midas/vseries.html"><b>vseries</b></A>
- display an ordered sequence of volume data sets
<br>
<A href="midas/wait.html"><b>wait</b></A>
- suspend command processing for a specified number of frames
or until motion has stopped
<br>
<A href="midas/windowsize.html"><b>windowsize</b></A>
- set the dimensions of the graphics window
</blockquote>
<p>
In addition, the commands
<A href="midas/sleep.html"><b>sleep</b></A> and 
<A href="midas/pause.html"><b>pause</b></A>
are useful for introducing pauses during live script execution, 
but not in movies, as no new frames are drawn during such pauses.
</p><p>
The graphics window should be adjusted to the desired dimensions
before recording, for example with the command
<A href="midas/windowsize.html"><b>windowsize</b></A>.
Using a small and standard size (320 x 240, 640 x 480, or 
800 x 600 pixels) may solve some <a href="#powerpoint">playback problems</a>.
On certain platforms, other windows should not overlap
the Chimera graphics window during recording
(<a href="print.html#exception">details...</a>).
</p>

<h3><a href="#top" class="nounder"><b>&larr;</b></a>
<a name="speed">Frame Rate and Movie Speed</a></h3>
<p>
In Chimera, the target or intended graphics frame rate is 60 fps (default). 
The actual frame rate may be lower depending on computer performance and
what is being displayed.  Recording generally slows the process further;
however, the frame rate of the resulting movie is controlled independently
with an encoding parameter (default 25 fps).
Thus, movie playback may be faster or slower than the original process 
in Chimera.  
</p><p>
The command <a href="midas/set.html#maxframerate"><b>set maxFrameRate</b></a>
can be used to set the Chimera target rate to match the movie frame rate,
so that &ldquo;live&rdquo; execution of a script
will show the movie contents at the same speed as the resulting movie
(or at least, as similar a speed as possible given performance limitations).
The
<a href="../ContributedSoftware/animation/frameanimation.html"
target="_top"><b>Animation</b></a>
tool sets the target rate to 25 fps temporarily during timeline playback.
The <a href="../ContributedSoftware/accelerators/alist.html">accelerator</a>
<b>rt</b> (command <b><A href="midas/ac.html">ac</A> rt</b>) 
allows monitoring the actual frame rate. 
</p>

<h3><a href="#top" class="nounder"><b>&larr;</b></a>
<a name="examples">Movie Command File Examples</a></h3>
<p>
Simply <a href="filetypes.html">opening</a> 
a <a href="indexcommand.html#cmdfile">command file</a>
in Chimera will execute its contents.
Command script execution can be aborted by pressing the <b>Esc</b> (escape) key,
or paused/resumed (with no new frames being drawn during the pause)
by pressing <b>Shift</b>-<b>Esc</b>.
<ul>
<li> <a href="../ContributedSoftware/recorder/1gfl.com" 
type="text/plain">1gfl.com</a> - fairly simple; 
fetches green fluorescent protein <b>1gfl</b> from the
<a href="https://www.rcsb.org" target="_blank">Protein Data Bank</a>,
rotates it, changes display styles
<li> <a href="../ContributedSoftware/recorder/tumble.com" 
type="text/plain">tumble.com</a> - also simple; shows a small molecule 
rotating and casting shadows on a planar object (see
<a href="https://www.rbvi.ucsf.edu/chimera/features.html#shadows"
target="blank"><b>Interactive shadows</b></a> in the Chimera Feature Highlights)
<li> Several entries in the 
<a href="https://www.rbvi.ucsf.edu/chimera/animations/animations.html"
target="_blank">Chimera Animation Gallery</a> include associated command
files and (if needed) other data, for example:
  <ul>
  <li>
  <a href="https://www.rbvi.ucsf.edu/chimera/animations/animations.html#trmovie"
  target="_blank"><b>Ball-and-socket motion</b></a> - morphing
  <li>
  <a href="https://www.rbvi.ucsf.edu/chimera/animations/animations.html#myosin-analysis"
  target="_blank"><b>Myosin thick filament analysis</b></a> - EM data, fitting
  <li>
  <a href="https://www.rbvi.ucsf.edu/chimera/animations/animations.html#binding-footprint"
  target="_blank"><b>Binding footprint</b></a>
  </ul>
</ul>
The online movie-making tutorials
(<a href="https://www.rbvi.ucsf.edu/chimera/data/tutorials/movies09/moviemaking.html" 
target="_blank">2009</a>,
<a href="https://www.rbvi.ucsf.edu/chimera/data/nih-oct2012/movies.html"
target="_blank">2012</a>)
and the <a href="https://www.rbvi.ucsf.edu/chimera/animations/animations.html"
target="_blank">Chimera Animation Gallery</a>
contain additional examples.  See also:
<a href="https://www.rbvi.ucsf.edu/chimera/data/movie-howto-mar2012/movie_examples.html" 
target="_blank">video mini-examples</a> for individual commands
</p>

<h3><a href="#top" class="nounder"><b>&larr;</b></a>
<a name="powerpoint">Problems in PowerPoint</a></h3>
<p>
On <b>Windows</b>,
some Chimera-generated movies cannot be inserted into PowerPoint 
presentations, or can be inserted but will not play.  
</p><p>
Using a small and standard frame size 
(320 x 240, 640 x 480, or 800 x 600 pixels)
may solve some playback problems.  
Before recording, the Chimera window can be
set to specific dimensions using the command
<A href="midas/windowsize.html"><b>windowsize</b></A>.
</p><p>
In PowerPoint 2000, only the Chimera <b>MPEG-1</b> format works, 
but the quality is very low.  Using PowerPoint 2003 or newer is recommended.  
With PowerPoint 2003 on Windows,
the Chimera <b>AVI MSMPEG-4v2</b> format is recommended.
Although a movie in this format can be inserted into a presentation, 
it may play as a black rectangle.
To remedy this, try reducing the video acceleration in Windows Media Player
(instructions are for Media Player 10.0, but should be similar for other
versions):
<ol>
<li>start Windows Media Player (for example,
by right-clicking a movie icon and choosing <b>Play with Media Player</b>)
<li>right-click the top bar of the Windows Media Player window
and choose menu entry  <b>Tools / Options...</b> 
<li>click the <b>Performance</b> tab in the <b>Options</b> dialog
<li>click the <b>Advanced...</b> button in the <b>Video Acceleration</b> panel
<li>turn off <b>Use video mixing renderer</b>
</ol>
After PowerPoint 2003 has been restarted, 
the movie should play correctly within the presentation.  
We have not tested movie playing in PowerPoint 2007.
A more drastic alternative to the last two steps above is to move the
slider in the <b>Video Acceleration</b> panel in the <b>Performance</b>
tab to <b>None</b>.
</p><p>
Video acceleration in Media Player is not the only potential source of trouble.
If the problem persists, see the Microsoft page on
<a href="https://support.microsoft.com/kb/905167" 
target="_blank">troubleshooting movies in PowerPoint</a>.
</p>

<hr>
<address>UCSF Computer Graphics Laboratory / May 2015</address>
</body>
</html>
