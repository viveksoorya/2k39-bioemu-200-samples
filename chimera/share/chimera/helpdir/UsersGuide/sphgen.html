<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2011 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html><head>
<title>Sphgen Sphere Files</title>
</head><body>
<h2>Sphgen Sphere Files</h2>
<p>
Chimera can <a href="filetypes.html#object">read</a> and 
<a href="#saving">write</a> spheres in the format produced by the
<a href="http://dock.compbio.ucsf.edu/index.html"
target="_blank">DOCK</a> accessory program
<a href="http://dock.compbio.ucsf.edu/DOCK_6/dock6_manual.htm#Sphgen"
target="_blank"><i>sphgen</i></a>.
DOCK uses the sphere centers as points for placing ligand atoms.
Chimera can be used to <a href="#editing">edit</a> sphere clusters
from <i>sphgen</i> and to <a href="#saving">save</a>
edited clusters or sets of atoms as spheres.  See also:
<a href="dms.html#writedms"><b>Write DMS</b></a>,
<a href="../ContributedSoftware/dockprep/dockprep.html"><b>Dock Prep</b></a>,
<a href="../ContributedSoftware/viewdock/framevd.html" 
target="_top"><b>ViewDock</b></a>
</p><p>
The sphgen input type is indicated by the filename suffix <b>.sph</b>
or by using <b><i>prefix:filename</i></b> in the command line,
where <b><i>prefix</i></b> is <b>sph</b>.
</p><p>
The small example file <a href="12123.sph">12123.sph</a> contains only
one cluster, whereas <i>sphgen</i> output generally contains multiple clusters,
including a &ldquo;cluster&rdquo; number 0 with all of the spheres.
Chimera loads each cluster as a molecule model and its spheres as atoms,
with sphere radii read from the file.
Clusters are assigned unique colors, and cluster 0 (if present)
is hidden automatically.
</p><p>
Cluster models are listed in the
<a href="modelpanel.html"><b>Model Panel</b></a>
and can be manipulated in the same ways as other molecule models.
Clusters read from the same sphere file are assigned the same model number
but sequential submodel numbers, which are not necessarily the same as the
cluster numbers given in the file.
For example, if a sphere file containing clusters 0, 1, and 2 
is opened as model 1, cluster 0 will be model #1.1, 
cluster 1 will be model #1.2, and cluster 2 will be model #1.3.
However, the names of the models will reflect the cluster numbers given
in the file.
</p>

<h3><a name="editing">Editing Sphere Clusters</a></h3>
<p>
Entire clusters (models) can be closed, and individual spheres can be 
<a href="selection.html">selected</a>, displayed/undisplayed, and 
<a href="../ContributedSoftware/editing/editing.html#deletion">deleted</a> 
like ordinary atoms. 
For selecting,
<a href="selection.html#pickselect">picking</a> from the graphics window
or with <a href="menu.html#selectzone"><b>Select... Zone</b></a> 
may be especially useful.  Just the displayed and/or 
selected spheres (atoms) can be <a href="#saving">saved</a>.
Conversely, unwanted spheres can be 
<a href="../ContributedSoftware/editing/editing.html#deletion">deleted</a> 
or undisplayed before the others are <a href="#saving">saved</a>.
</p><p>
Clusters can be merged using the 
<a href="modelpanel.html#combine"><b>copy/combine</b></a> function in the
<a href="modelpanel.html"><b>Model Panel</b></a> or the command
<a href="midas/combine.html"><b>combine</b></a>.
</p>

<h3><a name="saving">Saving Sphere Files</a></h3>
<p>
The dialog for saving a sphere file can be invoked with
<a href="modelpanel.html#savesph"><b>save sphgen</b></a>
in the <a href="modelpanel.html"><b>Model Panel</b></a>.
This function is only available after a sphere file has been opened.
Users lacking a sphere file but who wish to save atomic coordinates (such as 
a ligand in the binding site) as spheres can open the example file
<a href="12123.sph">12123.sph</a> in Chimera to enable sphere-saving.
If atoms are saved as spheres, their <a href="midas/vdwrad.html">VDW radii</a>
are used as the sphere radii.
</p><p>
<a name="chosen">Individual models or blocks of models can be chosen</a> 
from the <b>Save models</b> list with the left mouse button.  
Each chosen model will be written as a cluster.
</p><p>
Options:
<ul>
<li> <b>Save displayed atoms only</b> - only write coordinates of atoms 
(spheres) that are displayed
<li> <b>Save selected atoms only</b> - only write coordinates of atoms 
(spheres) that are <a href="selection.html">selected</a>
</ul>
Option when only one model is present:
<ul>
<li> <b>Use untransformed coordinates</b> - 
write coordinates without applying any rotations and translations 
that have been performed in Chimera.  This is recommended for spheres,
and is equivalent to writing a model relative to itself 
(see the multiple-model case below).
</ul>
Option when more than one model is present:
<ul>
<li> <b>Save relative to model [<i>model</i>]</b> -
save coordinates relative to the untransformed coordinates of a
specified reference <i>model</i> 
(otherwise, transformed coordinates will be saved).
This is useful for preserving the spatial relationship between models.
In most cases,
spheres should be written out relative to their original input model.
</ul>
</p>
<hr>
<address>UCSF Computer Graphics Laboratory / November 2011</address>
</body></html>
