<!--
--- UCSF Chimera Copyright ---
Copyright (c) 2014-2016 Regents of the University of California.
All rights reserved.  This software provided pursuant to a
license agreement containing restrictions on its disclosure,
duplication and use.  This notice must be embedded in or
attached to all copies, including partial copies, of the
software or any revisions or derivations thereof.
--- UCSF Chimera Copyright ---
-->

<html>
<head>
<TITLE>RR Distance Maps</TITLE>
<style type="text/css">
font.swatch {border: 1px solid black; vertical-align: top; font-size: 80%}
img.clRight {float: right; clear: right; margin: 0px 5px 5px 5px}
</style>
</head>
<body>

<h3>RR Distance Maps
<img src="distmapicon.png" alt="RR Distance Maps icon"></h3>

<a href="RRdist-sel.png"><img class="clRight" 
width="400px" style="border: 1px solid black" title="click for larger..."
src="RRdist-sel.png""></a>
<a href="RRdist-structs.png"><img class="clRight" 
width="260px" style="border: 1px solid black" title="click for larger..."
src="RRdist-structs.png""></a>

<p>
<b>RR Distance Maps</b> creates a <b><i>distance map</i></b>, 
a generalization of a 
<a href="https://en.wikipedia.org/wiki/Protein_contact_map" 
target="_blank">protein contact map</a>
in which residue-residue distances are shown with color gradations.
In a protein contact map,
a pair of residues is simply marked as contacting or not contacting
based on some criterion such as a cutoff distance.
<b>RR Distance Maps</b> generates a color-coded map of the C&alpha;-C&alpha; 
distances within an individual protein chain or a combined map for 
two or more related chains.  In a combined map, the average 
(intrachain) distances and/or their standard deviations can be shown.
Both quantities can be shown on the same map with different dimensions
of color. For two chains, a map of the distance differences can also be shown.
See also:
<a href="../ramachandran/ramachandran.html"><b>Ramachandran Plot</b></a>,
<a href="../findclash/findclash.html"><b>Find Clashes/Contacts</b></a>,
<a href="../morph/morph.html"><b>Morph Conformations</b></a>, 
<a href="../../UsersGuide/midas/distance.html"><b>distance</b></a>, and
<blockquote>
<a href="https://www.ncbi.nlm.nih.gov/pubmed/25540183" target="_blank">
RRDistMaps: a UCSF Chimera tool 
for viewing and comparing protein distance maps.</a>
Chen JE, Huang CC, Ferrin TE.
<i>Bioinformatics.</i> 2015 May 1;31(9):1484-6.
</blockquote>
<p>
There are <a href="../../UsersGuide/extension.html">several ways to start</a>
<b>RR Distance Maps</b>, a tool in the <b>Structure Comparison</b> category.
</p><p>
Individual chains or blocks of chains
can be chosen from the <b>Chains</b> list with the left mouse button.  
Ctrl-click toggles the status of an individual chain.
Only protein chains containing &alpha;-carbons will be handled.
If a single chain is chosen, an individual distance map will be generated. 
If multiple chains are chosen, they must have sequences similar enough
to be aligned. The sequences will be aligned to obtain residue equivalences,
and distance differences (if two chains), means, and standard deviations
will be calculated for equivalenced residue pairs.
</p><p>
Clicking <b>Calculate Map</b> aligns the sequences (if multiple chains)
and creates the map. The sequence alignment is shown in a
<a href="../multalignviewer/framemav.html" target="_top"><b>Multalign 
Viewer</b></a> window.
</p><p>
Choices for map <b>Display</b>:
<ul>
<li><b>Distance</b> 
- C&alpha;-C&alpha; distances within a single chain or average 
C&alpha;-C&alpha; distances among equivalenced residue pairs in multiple chains
<li><b>Std Dev</b> (multiple chains only)
- standard deviations of distances among equivalenced residue pairs
<li><b>Both</b> (multiple chains only)
- both the average distances and standard deviations 
among equivalenced residue pairs
<li><b>Difference</b> (two chains only) 
- differences in distance for equivalenced pairs:
the distance in the first structure minus that in the second
</ul>
The colors can be changed in the <a href="#rrmap-color">options</a>,
and values outside of the range of interest can be
<a href="#masking">masked</a> by adjusting the green outline
within the color key.
</p><p>
Clicking <b>Export</b> brings up a dialog for saving the matrix data
(distances, and if multiple chains, standard deviations, and if two chains,
differences) to a text file as tab-separated or comma-separated values.
<b>Close</b> exits from <b>RR Distance Maps</b>, and
<b>Help</b> opens this manual page in a browser window.
</p>

<a name="rrmap-mouse">
<h3>Mouse-Map Interactions</h3></a>
<p>
When the distance map window has mouse focus:
</p>
<ul>
<li>Placing the cursor over the map reports the corresponding value(s)
and structure residue IDs in the status area near the bottom of the window.
<br><br>
<li>Dragging to select a rectangle within the map 
<a href="../../UsersGuide/selection.html">selects</a> the
corresponding structure residues in the main Chimera window.
<br><br>
<li> <a name="masking">
The green outline within the color key to the right of the map
defines the range of colormapped values. 
The color key always contains the full range of values, 
but the edges of the green rectangle can be dragged smaller
and the whole rectangle can be dragged to reposition it within the key.
Values outside the range of the green rectangle are <b><i>masked</i></b> 
to a single color in the map
(the <a href="#rrmap-color">excluded color</a>, default almost-black).
</a>
The green rectangle cannot be resized continuously,
but the color key can be subdivided more finely using the
<a href="#rrmap-color">options</a>.
</ul>
<p>
If the map window becomes obscured by other windows, it can be resurrected 
with the <b>Raise</b> option for the <b>RR Distance Maps</b> 
<a href="../../UsersGuide/instances.html">instance in the <b>Tools</b> menu</a>.
</p><p>
Several standard <a href="../saxs/saxs.html#plotnav">navigation icons</a>
below the plot are provided by <a href="https://matplotlib.org"
target="_blank">matplotlib</a>. If a mouse mode such as zooming
is activated by clicking one of these icons, it is necessary to click 
the icon again to turn the mode off.
</p>

<a name="rrmap-color">
<h3>Colormap Options</h3></a>
<p>
Clicking <b>Options...</b> opens the <b>Colormap Options</b>:
</p>
<ul>
<li><b>Vertical resolution</b> (default <b>16</b>)
- number of vertical subdivisions in the color key
<li><b>Horizontal resolution</b> (default <b>16</b>)
- number of horizontal subdivisions in the color key, 
applicable when both distances and standard deviations are shown
<li><b>Low D, low SD color</b>
(a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>, default
<font class="swatch" style="background:#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font>&nbsp;)
- color for minimum distance
(and minimum standard deviation, if both are shown)
<li><b>High D, low SD color</b>
(a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>, default
<font class="swatch" style="background:#808080">&nbsp;&nbsp;&nbsp;&nbsp;</font>&nbsp;)
- color for maximum distance
(and minimum standard deviation, if both are shown)
<li><b>Low D, high SD color</b>
(a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>, default
<font class="swatch" style="background:#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;</font>&nbsp;)
- color for maximum standard deviation (and minimum distance, if both are shown)
<li><b>High D, high SD color</b>
(a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>, default 
<font class="swatch" style="background:#0080ff">&nbsp;&nbsp;&nbsp;&nbsp;</font>&nbsp;)
- color for maximum standard deviation and maximum distance when both are shown
<li><b>Excluded color</b>
(a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>, default
<font class="swatch" style="background:#333333">&nbsp;&nbsp;&nbsp;&nbsp;</font>&nbsp;)
- color for <a href="#masking">masked</a> values
(those beyond the range of the green outline rectangle in the color key)
<li><b>Negative difference color</b>
(a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>, default 
<font class="swatch" 
style="background:#ffff00">&nbsp;&nbsp;&nbsp;&nbsp;</font>&nbsp;)
- color for maximum negative distance difference
(shorter distance in the first structure)
<li><b>Zero difference color</b>
(a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>, default 
<font class="swatch" 
style="background:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</font>&nbsp;)
- color for zero difference
<li><b>Positive difference color</b>
(a <a href="../../UsersGuide/coloring.html#colorwell">color well</a>, default 
<font class="swatch" 
style="background:#00ffff">&nbsp;&nbsp;&nbsp;&nbsp;</font>&nbsp;)
- color for maximum positive distance difference
(longer distance in the first structure)
</ul>
<p>
Clicking <b>Apply</b> updates the map display;
it also removes any <a href="#masking">masking</a>, but subsequently 
the green rectangle can be resized smaller again to resume masking.
<b>Reset</b> restores the default settings in the dialog, and
<b>Cancel</b> simply dismisses the dialog.
</p><p>
<a name="binary">
<b>Note</b>: a simple binary contact-map-like appearance can be obtained by
<a href="#masking">masking</a> low (contact) distances after setting
the excluded color to black and all other colors to white,
or using some other similar dark-light scheme.
</a>
</p>

<a name="rrmap-notes">
<h3>Technical Notes</h3></a>
<p>
<b>Sequence alignments</b>. 
Pairwise alignments are calculated with the Needleman-Wunsch algorithm.
<!-- +10 on a match and -3 for mismatch -->
Multiple alignments are calculated with a MUSCLE web service, with settings
as described for <a href="../align/align.html"><b>Align Chain Sequences</b></a>.
</p><p>
<b>Combined (multiple-chain) maps only include residues from 
fully populated alignment columns</b>.
Only sequence alignment columns containing residues from all chosen chains
are used to define the residue equivalences in a combined map.
</p><p>
<b>Coloring is applied across the full value range</b>.
Although high and/or low values can be masked, 
colors can only be specified for the minimum and maximum values in the entire
map. It might be useful to specify colors for the minimum and maximum values
of a narrower range of interest to emphasize variations within that range.
</p><p>
<b>Combined (multiple-chain) maps omit terminal residues</b>.
Related to the preceding point,
the N-terminal two positions and C-terminal two positions are omitted from 
a combined map, because it was found that large standard deviations 
arising from these positions made it difficult to see variations 
on a smaller, more generally useful scale.
</p>

<hr>
<address>UCSF Computer Graphics Laboratory / June 2016</address>
</body>
</html>
